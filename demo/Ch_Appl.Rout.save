
R version 4.4.2 (2024-10-31) -- "Pile of Leaves"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> 
> ###################################################
> ### chunk number 2: setup
> ###################################################
> set.seed(290875)
> 
> 
> ###################################################
> ### chunk number 3: packages-4
> ###################################################
> library("sandwich")
> library("robustbase")
> library("lme4")
Loading required package: Matrix
> library("multcomp")
Loading required package: mvtnorm
Loading required package: survival

Attaching package: ‘survival’

The following object is masked from ‘package:robustbase’:

    heart

Loading required package: TH.data
Loading required package: MASS

Attaching package: ‘TH.data’

The following object is masked from ‘package:MASS’:

    geyser

> 
> 
> ###################################################
> ### chunk number 4: BoxplotRecovery
> ###################################################
> data("recovery", package = "multcomp")
> plot(minutes ~ blanket, data = recovery, 
+      xlab = "Blanket", ylab = "Minutes",
+      varwidth = TRUE, main = "")
> 
> 
> ###################################################
> ### chunk number 5: recovery-1
> ###################################################
> data("recovery", package = "multcomp")
> summary(recovery)
 blanket    minutes     
 b0:20   Min.   : 5.00  
 b1: 3   1st Qu.:12.00  
 b2: 3   Median :13.00  
 b3:15   Mean   :13.49  
         3rd Qu.:16.00  
         Max.   :19.00  
> 
> 
> ###################################################
> ### chunk number 6: recovery-2
> ###################################################
> recovery.aov <- aov(minutes ~ blanket, data = recovery)
> 
> 
> ###################################################
> ### chunk number 7: recovery-3
> ###################################################
> library("multcomp")
> recovery.mc <- glht(recovery.aov, 
+                      linfct = mcp(blanket = "Dunnett"), 
+                      alternative = "less")
> 
> 
> ###################################################
> ### chunk number 8: recovery-4
> ###################################################
> summary(recovery.mc)

	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Dunnett Contrasts


Fit: aov(formula = minutes ~ blanket, data = recovery)

Linear Hypotheses:
             Estimate Std. Error t value Pr(<t)    
b1 - b0 >= 0  -2.1333     1.6038  -1.330 0.2412    
b2 - b0 >= 0  -7.4667     1.6038  -4.656 <0.001 ***
b3 - b0 >= 0  -1.6667     0.8848  -1.884 0.0925 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
(Adjusted p values reported -- single-step method)

> 
> 
> ###################################################
> ### chunk number 9: recovery-5
> ###################################################
> summary(recovery.mc, test = adjusted(type = "bonferroni"))

	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Dunnett Contrasts


Fit: aov(formula = minutes ~ blanket, data = recovery)

Linear Hypotheses:
             Estimate Std. Error t value  Pr(<t)    
b1 - b0 >= 0  -2.1333     1.6038  -1.330   0.287    
b2 - b0 >= 0  -7.4667     1.6038  -4.656 6.1e-05 ***
b3 - b0 >= 0  -1.6667     0.8848  -1.884   0.101    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
(Adjusted p values reported -- bonferroni method)

> 
> 
> ###################################################
> ### chunk number 10: recovery-6
> ###################################################
> recovery.ci <- confint(recovery.mc, level = 0.95)
> recovery.ci

	 Simultaneous Confidence Intervals

Multiple Comparisons of Means: Dunnett Contrasts


Fit: aov(formula = minutes ~ blanket, data = recovery)

Quantile = 2.1816
95% family-wise confidence level
 

Linear Hypotheses:
             Estimate lwr     upr    
b1 - b0 >= 0 -2.1333     -Inf  1.3655
b2 - b0 >= 0 -7.4667     -Inf -3.9678
b3 - b0 >= 0 -1.6667     -Inf  0.2636

> 
> 
> ###################################################
> ### chunk number 11: recovery-6
> ###################################################
> plot(recovery.ci, main = "", ylim = c(0.5, 3.5), 
+       xlab = "Minutes")
> 
> 
> ###################################################
> ### chunk number 12: CIrecovery
> ###################################################
> plot(recovery.ci, main = "", ylim = c(0.5, 3.5), xlab = "Minutes")
> 
> 
> ###################################################
> ### chunk number 13: recovery-7a
> ###################################################
> contr <- rbind("b1 -b0" = c(-1, 1, 0, 0), 
+                 "b2 -b0" = c(-1, 0, 1, 0), 
+                 "b3 -b0" = c(-1, 0, 0, 1))
> summary(glht(recovery.aov, linfct = mcp(blanket = contr), 
+              alternative = "less"))

	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: User-defined Contrasts


Fit: aov(formula = minutes ~ blanket, data = recovery)

Linear Hypotheses:
            Estimate Std. Error t value Pr(<t)    
b1 -b0 >= 0  -2.1333     1.6038  -1.330 0.2412    
b2 -b0 >= 0  -7.4667     1.6038  -4.656 <1e-04 ***
b3 -b0 >= 0  -1.6667     0.8848  -1.884 0.0925 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
(Adjusted p values reported -- single-step method)

> 
> 
> ###################################################
> ### chunk number 14: recovery-8a
> ###################################################
> contr2 <- rbind("b2 -b0" = c(-1,  0, 1, 0), 
+                  "b2 -b1" = c( 0, -1, 1, 0), 
+                  "b3 -b0" = c(-1,  0, 0, 1), 
+                  "b3 -b1" = c( 0, -1, 0, 1))
> 
> 
> ###################################################
> ### chunk number 15: recovery-8c
> ###################################################
> summary(glht(recovery.aov, linfct = mcp(blanket = contr2), 
+               alternative = "less"))

	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: User-defined Contrasts


Fit: aov(formula = minutes ~ blanket, data = recovery)

Linear Hypotheses:
            Estimate Std. Error t value Pr(<t)    
b2 -b0 >= 0  -7.4667     1.6038  -4.656 <0.001 ***
b2 -b1 >= 0  -5.3333     2.1150  -2.522 0.0279 *  
b3 -b0 >= 0  -1.6667     0.8848  -1.884 0.1050    
b3 -b1 >= 0   0.4667     1.6383   0.285 0.9150    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
(Adjusted p values reported -- single-step method)

> 
> 
> ###################################################
> ### chunk number 16: recovery-9
> ###################################################
> summary(recovery.mc, test = adjusted(type = "free"))

	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Dunnett Contrasts


Fit: aov(formula = minutes ~ blanket, data = recovery)

Linear Hypotheses:
             Estimate Std. Error t value   Pr(<t)    
b1 - b0 >= 0  -2.1333     1.6038  -1.330   0.0958 .  
b2 - b0 >= 0  -7.4667     1.6038  -4.656 5.64e-05 ***
b3 - b0 >= 0  -1.6667     0.8848  -1.884   0.0640 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
(Adjusted p values reported -- free method)

> 
> 
> ###################################################
> ### chunk number 17: recovery-9
> ###################################################
> summary(recovery.mc, test = adjusted(type = "holm"))

	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Dunnett Contrasts


Fit: aov(formula = minutes ~ blanket, data = recovery)

Linear Hypotheses:
             Estimate Std. Error t value  Pr(<t)    
b1 - b0 >= 0  -2.1333     1.6038  -1.330  0.0958 .  
b2 - b0 >= 0  -7.4667     1.6038  -4.656 6.1e-05 ***
b3 - b0 >= 0  -1.6667     0.8848  -1.884  0.0675 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
(Adjusted p values reported -- holm method)

> 
> 
> ###################################################
> ### chunk number 18: immer-1
> ###################################################
> data("immer", package = "MASS")
> immer.aov <- aov((Y1 + Y2)/2 ~ Var + Loc, data = immer)
> summary(immer.aov)
            Df Sum Sq Mean Sq F value   Pr(>F)    
Var          4   2655   663.7   5.989  0.00245 ** 
Loc          5  10610  2122.1  19.148 5.21e-07 ***
Residuals   20   2217   110.8                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> 
> 
> ###################################################
> ### chunk number 19: immer-2
> ###################################################
> model.tables(immer.aov, type = "means")$tables$Var
Var
        M         P         S         T         V 
 94.39167 102.54167  91.13333 118.20000  99.18333 
> 
> 
> ###################################################
> ### chunk number 20: immer-3
> ###################################################
> immer.mc <- glht(immer.aov, linfct = mcp(Var = "Tukey"))
> 
> 
> ###################################################
> ### chunk number 21: immer-4
> ###################################################
> summary(immer.mc)

	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: aov(formula = (Y1 + Y2)/2 ~ Var + Loc, data = immer)

Linear Hypotheses:
           Estimate Std. Error t value Pr(>|t|)   
P - M == 0    8.150      6.078   1.341  0.67005   
S - M == 0   -3.258      6.078  -0.536  0.98243   
T - M == 0   23.808      6.078   3.917  0.00678 **
V - M == 0    4.792      6.078   0.788  0.93102   
S - P == 0  -11.408      6.078  -1.877  0.36074   
T - P == 0   15.658      6.078   2.576  0.11326   
V - P == 0   -3.358      6.078  -0.553  0.98035   
T - S == 0   27.067      6.078   4.453  0.00202 **
V - S == 0    8.050      6.078   1.324  0.67982   
V - T == 0  -19.017      6.078  -3.129  0.03768 * 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
(Adjusted p values reported -- single-step method)

> 
> 
> ###################################################
> ### chunk number 22: immer-4a
> ###################################################
> immer.mc2 <-TukeyHSD(immer.aov, which = "Var")
> immer.mc2$Var
          diff        lwr        upr       p adj
P-M   8.150000 -10.037586 26.3375861 0.670063958
S-M  -3.258333 -21.445919 14.9292527 0.982419709
T-M  23.808333   5.620747 41.9959194 0.006783701
V-M   4.791667 -13.395919 22.9792527 0.931020848
S-P -11.408333 -29.595919  6.7792527 0.360680099
T-P  15.658333  -2.529253 33.8459194 0.113221634
V-P  -3.358333 -21.545919 14.8292527 0.980350080
T-S  27.066667   8.879081 45.2542527 0.002027122
V-S   8.050000 -10.137586 26.2375861 0.679824487
V-T -19.016667 -37.204253 -0.8290806 0.037710044
> 
> 
> ###################################################
> ### chunk number 23: immer-4b
> ###################################################
> glht(immer.aov, linfct = mcp(Var = "Tukey"), 
+       alternative = "greater")

	 General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Linear Hypotheses:
           Estimate
P - M <= 0    8.150
S - M <= 0   -3.258
T - M <= 0   23.808
V - M <= 0    4.792
S - P <= 0  -11.408
T - P <= 0   15.658
V - P <= 0   -3.358
T - S <= 0   27.067
V - S <= 0    8.050
V - T <= 0  -19.017

> 
> 
> ###################################################
> ### chunk number 24: immer-5
> ###################################################
> immer.ci <- confint(immer.mc, level = 0.95)
> immer.ci

	 Simultaneous Confidence Intervals

Multiple Comparisons of Means: Tukey Contrasts


Fit: aov(formula = (Y1 + Y2)/2 ~ Var + Loc, data = immer)

Quantile = 2.9929
95% family-wise confidence level
 

Linear Hypotheses:
           Estimate lwr      upr     
P - M == 0   8.1500 -10.0408  26.3408
S - M == 0  -3.2583 -21.4492  14.9325
T - M == 0  23.8083   5.6175  41.9992
V - M == 0   4.7917 -13.3992  22.9825
S - P == 0 -11.4083 -29.5992   6.7825
T - P == 0  15.6583  -2.5325  33.8492
V - P == 0  -3.3583 -21.5492  14.8325
T - S == 0  27.0667   8.8758  45.2575
V - S == 0   8.0500 -10.1408  26.2408
V - T == 0 -19.0167 -37.2075  -0.8258

> 
> 
> ###################################################
> ### chunk number 25: immer-6
> ###################################################
> plot(immer.ci, main = "", xlab = "Yield")
> 
> 
> ###################################################
> ### chunk number 26: CIimmer
> ###################################################
> plot(immer.ci, main = "", xlab = "Yield")
> 
> 
> ###################################################
> ### chunk number 27: immer-7
> ###################################################
> immer.cld <- cld(immer.mc)
> 
> 
> ###################################################
> ### chunk number 28: immerCLD
> ###################################################
> plot(immer.cld)
> 
> 
> ###################################################
> ### chunk number 29: immerCLD
> ###################################################
> plot(immer.cld)
> 
> 
> ###################################################
> ### chunk number 30: immerCLD-2
> ###################################################
> data("immer", package = "MASS")
> library("HH")
Loading required package: lattice
Loading required package: grid
Loading required package: latticeExtra
Loading required package: gridExtra

Attaching package: ‘HH’

The following object is masked from ‘package:base’:

    is.R

> immer2 <- immer
> immer2$Var <- ordered(immer2$Var, 
+     levels = c("S", "M", "V", "P", "T"))
> immer2.aov <- aov((Y1 + Y2)/2 ~ Var + Loc, data = immer2)
> position(immer2$Var) <- model.tables(immer2.aov, 
+     type = "means")$tables$Var
> immer2.mc  <- glht(immer2.aov, linfct = mcp(Var = "Tukey"))
> immer2.cld <- cld(immer2.mc)
> immer2.cld$pos.x  <- immer2.cld$x
> position(immer2.cld$pos.x) <- position(immer2$Var)
> 
> lab <- 
+     immer2.cld$mcletters$monospacedLetters[levels(immer2$Var)]
> bwplot(lp ~ pos.x, data = immer2.cld,
+         panel=function(...){
+           panel.bwplot.intermediate.hh(...)
+           cpl <- current.panel.limits()
+           pushViewport(viewport(xscale = cpl$xlim,
+                                 yscale = cpl$ylim,
+                                 clip = "off"))
+           panel.axis("top", at = position(immer2$Var),
+                      labels = lab, outside = TRUE)
+           upViewport()
+         },
+         scales = list(x = list(limits = c(90, 120),
+                       at = position(immer2$Var),
+                       labels = levels(immer2$Var))),
+         main = "", xlab = "Var", ylab = "linear predictor")
> 
> 
> ###################################################
> ### chunk number 31: immerCLD-2
> ###################################################
> print(bwplot(lp ~ pos.x, data=immer2.cld,
+        panel=function(...){
+          panel.bwplot.intermediate.hh(...)
+          cpl <- current.panel.limits()
+          pushViewport(viewport(xscale = cpl$xlim,
+                                yscale = cpl$ylim,
+                                clip = "off"))
+          panel.axis("top", at=position(immer2$Var),
+                     labels=immer2.cld$mcletters$monospacedLetters[levels(immer2$Var)],
+                     outside=TRUE)
+          upViewport()
+        },
+        scales=list(x=list(limits=c(90,120),
+                      at=position(immer2$Var),
+                      labels=levels(immer2$Var))),
+        main="", col="black", xlab="Var", ylab="linear predictor"))
> 
> 
> ###################################################
> ### chunk number 32: immer-9
> ###################################################
> library("HH")
> immer.mmc <- mmc(immer.aov, linfct = mcp(Var = "Tukey"), 
+                  focus = "Var", lmat.rows = 2:5)
> 
> 
> ###################################################
> ### chunk number 33: immer-linfct
> ###################################################
> rownames(immer.mc$linfct) <- gsub(" ", "", rownames(immer.mc$linfct))
> 
> 
> ###################################################
> ### chunk number 34: immer-10
> ###################################################
> t(immer.mc$linfct)
            P-M S-M T-M V-M S-P T-P V-P T-S V-S V-T
(Intercept)   0   0   0   0   0   0   0   0   0   0
VarP          1   0   0   0  -1  -1  -1   0   0   0
VarS          0   1   0   0   1   0   0  -1  -1   0
VarT          0   0   1   0   0   1   0   1   0  -1
VarV          0   0   0   1   0   0   1   0   1   1
LocD          0   0   0   0   0   0   0   0   0   0
LocGR         0   0   0   0   0   0   0   0   0   0
LocM          0   0   0   0   0   0   0   0   0   0
LocUF         0   0   0   0   0   0   0   0   0   0
LocW          0   0   0   0   0   0   0   0   0   0
attr(,"type")
[1] "Tukey"
> 
> 
> ###################################################
> ### chunk number 35: immer-11
> ###################################################
> plot(immer.mmc, ry = c(85, 122), x.offset = 8, 
+       main = "", main2 = "")
> 
> 
> ###################################################
> ### chunk number 36: immerMMC
> ###################################################
> # par(mai = par("mai") * c(1, 1, 1, 1.1))
> layout(matrix(1:2, ncol = 1))
> plot(immer.mmc, ry=c(85, 122), x.offset = 8, 
+      main = "Mean-mean multiple comparison plot", main2 = "",
+      col.mca.signif = "grey")
> ### plot.matchMMC doesn't exist in HH
> if (FALSE) {
+ plot.matchMMC(immer.mmc$mca, main = "Tiebreaker plot",
+               col.signif = "grey")
+ 
+ 
+ ###################################################
+ ### chunk number 37: immer-11a
+ ###################################################
+ plot.matchMMC(immer.mmc$mca, main = "")
+ }
> 
> ###################################################
> ### chunk number 38: immer-12
> ###################################################
> immer.lmat <- cbind("M-S"    = c(1, 0,-1, 0, 0),
+                      "MS-V"   = c(1, 0, 1, 0,-2),
+                      "VMS-P"  = c(1,-3, 1, 0, 1),
+                      "PVMS-T" = c(1, 1, 1,-4, 1))
> row.names(immer.lmat) <- c("M","P","S","T","V")
> 
> 
> ###################################################
> ### chunk number 39: immer-12
> ###################################################
> immer.mmc2 <- mmc(immer.aov, linfct = mcp(Var = "Tukey"), 
+                   focus.lmat = immer.lmat)
> 
> 
> ###################################################
> ### chunk number 40: immerMMC2
> ###################################################
> plot(immer.mmc2, ry = c(85, 122), x.offset = 8, main = "", main2 = "", col.lmat.signif = "grey")
> 
> 
> ###################################################
> ### chunk number 41: immer-7
> ###################################################
> summary(immer.mc, test = adjusted(type = "Westfall"))

	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: aov(formula = (Y1 + Y2)/2 ~ Var + Loc, data = immer)

Linear Hypotheses:
         Estimate Std. Error t value Pr(>|t|)   
P-M == 0    8.150      6.078   1.341  0.38995   
S-M == 0   -3.258      6.078  -0.536  0.82566   
T-M == 0   23.808      6.078   3.917  0.00459 **
V-M == 0    4.792      6.078   0.788  0.43973   
S-P == 0  -11.408      6.078  -1.877  0.26897   
T-P == 0   15.658      6.078   2.576  0.06162 . 
V-P == 0   -3.358      6.078  -0.553  0.82566   
T-S == 0   27.067      6.078   4.453  0.00200 **
V-S == 0    8.050      6.078   1.324  0.39845   
V-T == 0  -19.017      6.078  -3.129  0.01901 * 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
(Adjusted p values reported -- Westfall method)

> 
> 
> ###################################################
> ### chunk number 42: immer-8
> ###################################################
> summary(immer.mc, test = adjusted(type = "none"))

	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: aov(formula = (Y1 + Y2)/2 ~ Var + Loc, data = immer)

Linear Hypotheses:
         Estimate Std. Error t value Pr(>|t|)    
P-M == 0    8.150      6.078   1.341 0.194983    
S-M == 0   -3.258      6.078  -0.536 0.597810    
T-M == 0   23.808      6.078   3.917 0.000854 ***
V-M == 0    4.792      6.078   0.788 0.439728    
S-P == 0  -11.408      6.078  -1.877 0.075185 .  
T-P == 0   15.658      6.078   2.576 0.018029 *  
V-P == 0   -3.358      6.078  -0.553 0.586700    
T-S == 0   27.067      6.078   4.453 0.000244 ***
V-S == 0    8.050      6.078   1.324 0.200289    
V-T == 0  -19.017      6.078  -3.129 0.005288 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
(Adjusted p values reported -- none method)

> 
> 
> ###################################################
> ### chunk number 43: immer-9
> ###################################################
> summary(immer.mc, test = adjusted(type = "Shaffer"))

	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: aov(formula = (Y1 + Y2)/2 ~ Var + Loc, data = immer)

Linear Hypotheses:
         Estimate Std. Error t value Pr(>|t|)   
P-M == 0    8.150      6.078   1.341  0.58495   
S-M == 0   -3.258      6.078  -0.536  1.00000   
T-M == 0   23.808      6.078   3.917  0.00512 **
V-M == 0    4.792      6.078   0.788  0.60087   
S-P == 0  -11.408      6.078  -1.877  0.45111   
T-P == 0   15.658      6.078   2.576  0.07212 . 
V-P == 0   -3.358      6.078  -0.553  1.00000   
T-S == 0   27.067      6.078   4.453  0.00244 **
V-S == 0    8.050      6.078   1.324  0.60087   
V-T == 0  -19.017      6.078  -3.129  0.02115 * 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
(Adjusted p values reported -- Shaffer method)

> 
> 
> ###################################################
> ### chunk number 44: Thalidomide-plot
> ###################################################
> lsmDat <- data.frame(dose = c(0, 5, 50, 500),
+     doseC = 1:4,
+     mean = c(32.3651425, 29.0127426, 30.0742635, 29.6898998),
+     se = c(0.8939097, 0.9294513, 0.9978421, 0.9902196))
> library("lattice")
> print(xyplot(mean ~ dose, lsmDat, xlab = "Dose", ylab = "Litter weight LSMEANS (g)",
+        panel = function(x, y, se, ...) {
+            lsegments(x, y - se, x, y + se, col = "gray80", lwd = 3)
+            panel.xyplot(x, y, type = "b", col = "black", lwd = 2, cex = 1.25)
+        }, se = lsmDat$se, ylim = c(27, 34)))
> 
> 
> ###################################################
> ### chunk number 45: litter-1
> ###################################################
> data("litter", package = "multcomp")
> litter.aov <- aov(weight ~ dose + gesttime + number, 
+                    data = litter)
> 
> 
> ###################################################
> ### chunk number 46: litter-1
> ###################################################
> litter.mc <- glht(litter.aov, linfct = mcp(dose = "Dunnett"), 
+                    alternative = "less")
> summary(litter.mc, test = adjusted(type = "single-step"))

	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Dunnett Contrasts


Fit: aov(formula = weight ~ dose + gesttime + number, data = litter)

Linear Hypotheses:
             Estimate Std. Error t value Pr(<t)  
5 - 0 >= 0     -3.352      1.291  -2.597 0.0160 *
50 - 0 >= 0    -2.291      1.338  -1.712 0.1119  
500 - 0 >= 0   -2.675      1.334  -2.005 0.0627 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
(Adjusted p values reported -- single-step method)

> 
> 
> ###################################################
> ### chunk number 47: litter-fig1
> ###################################################
> library("lattice")
> contMat <- matrix(c(
+ 1,             0,        0,      -1, 
+ 1,             0,     -0.5,    -0.5, 
+ 1,       -0.3333,  -0.3333, -0.3333,
+ 0.5,         0.5,     -0.5,    -0.5,
+ 0.5,         0.5,        0,      -1,
+ 0.3333,   0.3333,   0.3333,      -1,
+ 1,             0,        0,      -1, 
+ 1,             0,     -0.5,    -0.5, 
+ 1,       -0.3333,  -0.3333, -0.3333
+ ), ncol=4, byrow=TRUE)
> contMat <- t(contMat)
> 
> contNames <- c("Williams 1", "Williams 2", "Williams 3",
+     "mod Williams 1","mod Williams 2","mod Williams 3","mod Williams 4","mod Williams 5","mod Williams 6")
> contMatTrl <- data.frame(cont = as.vector(contMat),
+                          type = factor(rep(contNames, each = 4), levels = contNames),
+                          type2 = factor(rep(c("Williams", "modified Williams"), c(12, 24))),
+                          dose = rep(0:3, 9))
> 
> trellis.par.set("superpose.line",
+                 list(col = c("lightgrey", "lightgrey", "lightgrey", "darkgrey", "darkgrey", "darkgrey"),
+                      lty = c(4, 4, 4, 1, 1, 1),
+                      lwd = rep(3, 6)))
> trellis.par.set("superpose.symbol",
+                 list(col = c(1, 1, 1, 1, 1, 1),
+                      pch = c(1, 1, 1, 2, 2, 2), 
+                      cex = rep(1, 6),
+                      font = rep(1, 6)))
> 
> print(xyplot(cont ~ dose | type2, contMatTrl, 
+        panel = function(x, y, subscripts, groups, ...) {
+                   panel.superpose(x, y, subscripts, groups,  type = "l", ...)
+                   panel.superpose(x, y, subscripts, groups, type = "p", ...)
+                },
+        groups = type, xlab = "Dose", ylab = "Contrast"))
> 
> 
> ###################################################
> ### chunk number 48: litter-3
> ###################################################
> n <- c(20, 19, 18, 17)
> -contrMat(n, type = "Williams")

	 Multiple Comparisons of Means: Williams Contrasts

    1       2       3       4
C 1 1  0.0000  0.0000 -1.0000
C 2 1  0.0000 -0.5143 -0.4857
C 3 1 -0.3519 -0.3333 -0.3148
> 
> 
> ###################################################
> ### chunk number 49: litter-4
> ###################################################
> -contrMat(n, type = "Marcus")

	 Multiple Comparisons of Means: Marcus Contrasts

         1       2       3       4
C 1 1.0000 -0.3519 -0.3333 -0.3148
C 2 1.0000  0.0000 -0.5143 -0.4857
C 3 0.5128  0.4872 -0.5143 -0.4857
C 4 1.0000  0.0000  0.0000 -1.0000
C 5 0.5128  0.4872  0.0000 -1.0000
C 6 0.3509  0.3333  0.3158 -1.0000
> 
> 
> ###################################################
> ### chunk number 50: litter-5a
> ###################################################
> set.seed(1234)
> 
> 
> ###################################################
> ### chunk number 51: litter-5
> ###################################################
> litter.mc2 <- glht(litter.aov, alternative = "less",
+                     linfct = mcp(dose = "Williams"))
> summary(litter.mc2)

	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Williams Contrasts


Fit: aov(formula = weight ~ dose + gesttime + number, data = litter)

Linear Hypotheses:
         Estimate Std. Error t value  Pr(<t)   
C 1 >= 0   -2.675      1.334  -2.005 0.04365 * 
C 2 >= 0   -2.478      1.123  -2.207 0.02846 * 
C 3 >= 0   -2.785      1.046  -2.662 0.00941 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
(Adjusted p values reported -- single-step method)

> 
> 
> ###################################################
> ### chunk number 52: litter-6
> ###################################################
> glht(litter.aov, linfct = mcp(dose = "Marcus"), 
+       alternative = "less")

	 General Linear Hypotheses

Multiple Comparisons of Means: Marcus Contrasts


Linear Hypotheses:
         Estimate
C 1 >= 0  -2.7854
C 2 >= 0  -2.4776
C 3 >= 0  -0.8443
C 4 >= 0  -2.6752
C 5 >= 0  -1.0420
C 6 >= 0  -0.8343

> 
> 
> ###################################################
> ### chunk number 53: litter-7
> ###################################################
> summary(litter.mc2, test = adjusted(type = "free"))

	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Williams Contrasts


Fit: aov(formula = weight ~ dose + gesttime + number, data = litter)

Linear Hypotheses:
         Estimate Std. Error t value  Pr(<t)   
C 1 >= 0   -2.675      1.334  -2.005 0.02448 * 
C 2 >= 0   -2.478      1.123  -2.207 0.02374 * 
C 3 >= 0   -2.785      1.046  -2.662 0.00978 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
(Adjusted p values reported -- free method)

> 
> 
> ###################################################
> ### chunk number 54: body-1
> ###################################################
> data("bodyfat", package = "TH.data")
> bodyfat.lm <- lm(DEXfat ~ ., data = bodyfat)
> summary(bodyfat.lm)

Call:
lm(formula = DEXfat ~ ., data = bodyfat)

Residuals:
   Min     1Q Median     3Q    Max 
-6.954 -1.949 -0.219  1.169 10.812 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -69.02828    7.51686  -9.183 4.18e-13 ***
age            0.01996    0.03221   0.620  0.53777    
waistcirc      0.21049    0.06714   3.135  0.00264 ** 
hipcirc        0.34351    0.08037   4.274 6.85e-05 ***
elbowbreadth  -0.41237    1.02291  -0.403  0.68826    
kneebreadth    1.75798    0.72495   2.425  0.01829 *  
anthro3a       5.74230    5.20752   1.103  0.27449    
anthro3b       9.86643    5.65786   1.744  0.08622 .  
anthro3c       0.38743    2.08746   0.186  0.85338    
anthro4       -6.57439    6.48918  -1.013  0.31500    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 3.281 on 61 degrees of freedom
Multiple R-squared:  0.9231,	Adjusted R-squared:  0.9117 
F-statistic: 81.35 on 9 and 61 DF,  p-value: < 2.2e-16

> 
> 
> ###################################################
> ### chunk number 55: body-opt
> ###################################################
> op <- options(width = 70)
> 
> 
> ###################################################
> ### chunk number 56: body-2
> ###################################################
> K <- cbind(0, diag(length(coef(bodyfat.lm)) - 1))
> rownames(K) <- names(coef(bodyfat.lm))[-1]
> K
             [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
age             0    1    0    0    0    0    0    0    0     0
waistcirc       0    0    1    0    0    0    0    0    0     0
hipcirc         0    0    0    1    0    0    0    0    0     0
elbowbreadth    0    0    0    0    1    0    0    0    0     0
kneebreadth     0    0    0    0    0    1    0    0    0     0
anthro3a        0    0    0    0    0    0    1    0    0     0
anthro3b        0    0    0    0    0    0    0    1    0     0
anthro3c        0    0    0    0    0    0    0    0    1     0
anthro4         0    0    0    0    0    0    0    0    0     1
> 
> 
> ###################################################
> ### chunk number 57: body-opt
> ###################################################
> options(op)
> 
> 
> ###################################################
> ### chunk number 58: body-3
> ###################################################
> bodyfat.mc <- glht(bodyfat.lm, linfct = K)
> 
> 
> ###################################################
> ### chunk number 59: body-4
> ###################################################
> summary(bodyfat.mc, test = Ftest())

	 General Linear Hypotheses

Linear Hypotheses:
                  Estimate
age == 0           0.01996
waistcirc == 0     0.21049
hipcirc == 0       0.34351
elbowbreadth == 0 -0.41237
kneebreadth == 0   1.75798
anthro3a == 0      5.74230
anthro3b == 0      9.86643
anthro3c == 0      0.38743
anthro4 == 0      -6.57439

Global Test:
      F DF1 DF2    Pr(>F)
1 81.35   9  61 1.387e-30
> 
> 
> ###################################################
> ### chunk number 60: body-4
> ###################################################
> summary(bodyfat.mc)

	 Simultaneous Tests for General Linear Hypotheses

Fit: lm(formula = DEXfat ~ ., data = bodyfat)

Linear Hypotheses:
                  Estimate Std. Error t value Pr(>|t|)    
age == 0           0.01996    0.03221   0.620   0.9959    
waistcirc == 0     0.21049    0.06714   3.135   0.0209 *  
hipcirc == 0       0.34351    0.08037   4.274   <0.001 ***
elbowbreadth == 0 -0.41237    1.02291  -0.403   0.9998    
kneebreadth == 0   1.75798    0.72495   2.425   0.1319    
anthro3a == 0      5.74230    5.20752   1.103   0.8946    
anthro3b == 0      9.86643    5.65786   1.744   0.4780    
anthro3c == 0      0.38743    2.08746   0.186   1.0000    
anthro4 == 0      -6.57439    6.48918  -1.013   0.9293    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
(Adjusted p values reported -- single-step method)

> 
> 
> ###################################################
> ### chunk number 61: body-5
> ###################################################
> vcov.lmrob <-function(object) object$cov
> summary(glht(lmrob(DEXfat ~ ., data = bodyfat), 
+               linfct = K))

	 Simultaneous Tests for General Linear Hypotheses

Fit: lmrob(formula = DEXfat ~ ., data = bodyfat)

Linear Hypotheses:
                  Estimate Std. Error z value Pr(>|z|)    
age == 0           0.02644    0.01930   1.370  0.72178    
waistcirc == 0     0.23243    0.06714   3.462  0.00433 ** 
hipcirc == 0       0.32863    0.07571   4.341  < 0.001 ***
elbowbreadth == 0 -0.27318    0.92260  -0.296  0.99998    
kneebreadth == 0   0.77661    0.52679   1.474  0.64581    
anthro3a == 0      2.12400    3.68426   0.577  0.99704    
anthro3b == 0     10.27634    4.76233   2.158  0.20501    
anthro3c == 0      1.93582    1.39153   1.391  0.70633    
anthro4 == 0      -5.82252    5.55661  -1.048  0.90697    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
(Adjusted p values reported -- single-step method)

Warning message:
In RET$pfunction("adjusted", ...) : Completion with error > abseps
> 
> 
> ###################################################
> ### chunk number 62: scb-2
> ###################################################
> data("sbp", package = "multcomp")
> sbp.lm <- lm(sbp ~ gender * age, data = sbp)
> coef(sbp.lm)
     (Intercept)     genderfemale              age genderfemale:age 
    110.03852854     -12.96144428       0.96135261      -0.01203008 
> 
> 
> ###################################################
> ### chunk number 63: scb-3
> ###################################################
> age <- seq(from = 17, to = 47, by = 1)
> K <- cbind(0, 1, 0, age)
> rownames(K) <- paste("age", age, sep = "")
> 
> 
> ###################################################
> ### chunk number 64: scb-4
> ###################################################
> sbp.mc <- glht(sbp.lm, linfct = K)
> sbp.ci <- confint(sbp.mc, level = 0.99)
> 
> 
> ###################################################
> ### chunk number 65: scb-4a
> ###################################################
> attr(sbp.ci$confint, "calpha")
[1] 2.974583
> 
> 
> ###################################################
> ### chunk number 66: scb5
> ###################################################
> plot(age, coef(sbp.mc), type = "l", ylim = c(-30, 2))
> lines(age, sbp.ci$confint[,"upr"])
> lines(age, sbp.ci$confint[,"lwr"])
> abline(h = 0, lty = 2)
> 
> 
> ###################################################
> ### chunk number 67: scb
> ###################################################
> plot(age, coef(sbp.mc), type = "l", ylim = c(-30, 2), 
+      ylab = expression(x^T * (beta[F] - beta[M])), main = "", 
+      xlab = "Age")
> points(age, coef(sbp.mc), pch = 19, cex = 0.6)
> lines(age, sbp.ci$confint[,"upr"])
> lines(age, sbp.ci$confint[,"lwr"])
> abline(h = 0, lty = 2)
> 
> 
> ###################################################
> ### chunk number 68: alpha-data
> ###################################################
> data("alpha", package = "coin")
> 
> 
> ###################################################
> ### chunk number 69: alpha-data-figure
> ###################################################
> levels(alpha$alength)[2] <- "med"
> n <- table(alpha$alength)
> boxplot(elevel ~ alength, data = alpha, ylab = "Expression level",
+         xlab = "NACP-REP1 Allele Length", varwidth = TRUE)
> axis(3, at = 1:3, labels = paste("n = ", n))
> rankif <- function(data) trafo(data, numeric_trafo = rank)
> 
> 
> ###################################################
> ### chunk number 70: alpha-3
> ###################################################
> alpha.aov <- aov(elevel ~ alength, data = alpha)
> 
> 
> ###################################################
> ### chunk number 71: alpha-4
> ###################################################
> alpha.mc <- glht(alpha.aov, linfct = mcp(alength = "Tukey"))
> 
> 
> ###################################################
> ### chunk number 72: alpha-3
> ###################################################
> alpha.mc$linfct
             (Intercept) alengthmed alengthlong
med - short            0          1           0
long - short           0          0           1
long - med             0         -1           1
attr(,"type")
[1] "Tukey"
> 
> 
> ###################################################
> ### chunk number 73: alpha-aov-coefvcov
> ###################################################
> coef(alpha.mc)
 med - short long - short   long - med 
   0.4341523    1.1887500    0.7545977 
> vcov(alpha.mc)
             med - short long - short  long - med
med - short   0.14717604    0.1041001 -0.04307591
long - short  0.10410012    0.2706603  0.16656020
long - med   -0.04307591    0.1665602  0.20963611
> 
> 
> ###################################################
> ### chunk number 74: alpha-aov-results
> ###################################################
> confint(alpha.mc)

	 Simultaneous Confidence Intervals

Multiple Comparisons of Means: Tukey Contrasts


Fit: aov(formula = elevel ~ alength, data = alpha)

Quantile = 2.3722
95% family-wise confidence level
 

Linear Hypotheses:
                  Estimate lwr      upr     
med - short == 0   0.43415 -0.47591  1.34421
long - short == 0  1.18875 -0.04539  2.42289
long - med == 0    0.75460 -0.33154  1.84073

> summary(alpha.mc)

	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: aov(formula = elevel ~ alength, data = alpha)

Linear Hypotheses:
                  Estimate Std. Error t value Pr(>|t|)  
med - short == 0    0.4342     0.3836   1.132   0.4924  
long - short == 0   1.1888     0.5203   2.285   0.0614 .
long - med == 0     0.7546     0.4579   1.648   0.2270  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
(Adjusted p values reported -- single-step method)

> 
> 
> ###################################################
> ### chunk number 75: alpha-aov-tukey-sandwich
> ###################################################
> alpha.mc2 <- glht(alpha.aov, linfct = mcp(alength = "Tukey"), 
+                    vcov = sandwich)
> summary(alpha.mc2)

	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: aov(formula = elevel ~ alength, data = alpha)

Linear Hypotheses:
                  Estimate Std. Error t value Pr(>|t|)  
med - short == 0    0.4342     0.4239   1.024   0.5594  
long - short == 0   1.1888     0.4432   2.682   0.0227 *
long - med == 0     0.7546     0.3184   2.370   0.0501 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
(Adjusted p values reported -- single-step method)

> 
> 
> ###################################################
> ### chunk number 76: alpha-confint-plot
> ###################################################
> layout(matrix(1:2, ncol = 1))
> ci1 <- confint(glht(alpha.aov, linfct = mcp(alength = "Tukey")))
> ci2 <- confint(glht(alpha.aov, linfct = mcp(alength = "Tukey"), vcov = sandwich))
> plot(ci1, main = "Ordinary covariance matrix estimate", ylim = c(0.5, 3.5), 
+      xlab = "Difference")
> plot(ci2, main = "Sandwich estimate", ylim = c(0.5, 3.5), xlab = "Difference")
> layout(matrix(1:1, ncol = 1))
> 
> 
> ###################################################
> ### chunk number 77: alzheimer-demographics
> ###################################################
> data("alzheimer", package = "coin")
> total <- nrow(alzheimer)
> stopifnot(total == 538) 
> male <- sum(alzheimer$gender == "Male")
> stopifnot(male == 200)
> female <- sum(alzheimer$gender == "Female")
> stopifnot(female == 338)
> disease <- table(alzheimer$disease)
> smoked <- sum(alzheimer$smoking != "None")
> atab <- xtabs(~ smoking + disease + gender, data = alzheimer)
> ### there is a discrepancy between Table 1 (32% smokers of 117 women
> ### suffering from other diagnoses) and Table 4 (63% non-smokers).  
> ### We used the data as given in Table 4.
> 
> 
> ###################################################
> ### chunk number 78: alzheimer-tab
> ###################################################
> x <- t(atab[,,"Female"])
> lines <- paste(paste(dimnames(x)$disease, " & "),
+                 paste(apply(x, 1, function(l) paste(l, collapse = " & ")), 
+ "\\\\"))
> for (i in 1:length(lines)) cat(lines[i], "\n")
Alzheimer  &  91 & 7 & 15 & 21 \\ 
Other dementias  &  55 & 7 & 16 & 9 \\ 
Other diagnoses  &  80 & 3 & 25 & 9 \\ 
> 
> 
> ###################################################
> ### chunk number 79: alzheimer-tab
> ###################################################
> x <- t(atab[,,"Male"])
> lines <- paste(paste(dimnames(x)$disease, " & "),
+                 paste(apply(x, 1, function(l) paste(l, collapse = " & ")), 
+ "\\\\"))
> for (i in 1:length(lines)) cat(lines[i], "\n")
Alzheimer  &  35 & 8 & 15 & 6 \\ 
Other dementias  &  24 & 1 & 17 & 35 \\ 
Other diagnoses  &  24 & 2 & 22 & 11 \\ 
> 
> 
> ###################################################
> ### chunk number 80: alzheimer-plot
> ###################################################
> layout(matrix(1:2, ncol = 2))
> spineplot(disease ~ smoking, data = alzheimer, subset = gender == "Male",
+ main = "Male", xlab = "Smoking", ylab = "Disease", tol = 1)
> spineplot(disease ~ smoking, data = alzheimer, subset = gender == "Female",
+ main = "Female", xlab = "Smoking", ylab = "Disease", tol = 1)
> 
> 
> ###################################################
> ### chunk number 81: alzheimer-plot
> ###################################################
> layout(matrix(1:1, ncol = 1))
> 
> 
> ###################################################
> ### chunk number 82: alz-1
> ###################################################
> data("alzheimer", package = "coin")
> y <- factor(alzheimer$disease == "Alzheimer", 
+              labels = c("other", "Alzheimer"))
> alzheimer.glm <- glm(y ~ smoking * gender, 
+      data = alzheimer, family = binomial())
> 
> 
> ###################################################
> ### chunk number 83: alz-options
> ###################################################
> op <- options(show.signif.stars = FALSE)
> 
> 
> ###################################################
> ### chunk number 84: alz-2
> ###################################################
> summary(alzheimer.glm)

Call:
glm(formula = y ~ smoking * gender, family = binomial(), data = alzheimer)

Coefficients:
                        Estimate Std. Error z value Pr(>|z|)
(Intercept)             -0.39442    0.13563  -2.908 0.003638
smoking<10               0.03774    0.51113   0.074 0.941140
smoking10-20            -0.61111    0.33084  -1.847 0.064725
smoking>20               0.54857    0.34867   1.573 0.115647
genderMale               0.07856    0.26039   0.302 0.762870
smoking<10:genderMale    1.25894    0.87692   1.436 0.151105
smoking10-20:genderMale -0.02855    0.50116  -0.057 0.954568
smoking>20:genderMale   -2.26959    0.59948  -3.786 0.000153

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 707.90  on 537  degrees of freedom
Residual deviance: 673.55  on 530  degrees of freedom
AIC: 689.55

Number of Fisher Scoring iterations: 4

> 
> 
> ###################################################
> ### chunk number 85: alz-options
> ###################################################
> options(op)
> 
> 
> ###################################################
> ### chunk number 86: alzheimer-K
> ###################################################
> a <- cbind(levels(alzheimer$smoking), "Female")
> b <- cbind(levels(alzheimer$smoking), "Male")
> d <- rbind(a, b)
> smk <- factor(d[,1], levels = levels(alzheimer$smoking))
> gen <- factor(d[,2], levels = levels(alzheimer$gender))
> d <- data.frame(smk, gen)
> ### colnames(d) <- c("smoking", "gender")
> colnames(d) <- c("s", "g")
> rownames(d) <- paste(d[,1], d[,2], sep = ":")
> K <- model.matrix(~ s * g, data = d)
> colnames(K)[1] <- "(Icpt)"
> attr(K, "assign") <- NULL
> attr(K, "contrasts") <- NULL
> 
> 
> ###################################################
> ### chunk number 87: alz-3
> ###################################################
> K
             (Icpt) s<10 s10-20 s>20 gMale s<10:gMale s10-20:gMale s>20:gMale
None:Female       1    0      0    0     0          0            0          0
<10:Female        1    1      0    0     0          0            0          0
10-20:Female      1    0      1    0     0          0            0          0
>20:Female        1    0      0    1     0          0            0          0
None:Male         1    0      0    0     1          0            0          0
<10:Male          1    1      0    0     1          1            0          0
10-20:Male        1    0      1    0     1          0            1          0
>20:Male          1    0      0    1     1          0            0          1
> 
> 
> ###################################################
> ### chunk number 88: alz-3
> ###################################################
> alzheimer.ci <- confint(glht(alzheimer.glm, linfct = K))
> 
> 
> ###################################################
> ### chunk number 89: alz-3a
> ###################################################
> attr(alzheimer.ci$confint, "calpha")
[1] 2.727109
> 
> 
> ###################################################
> ### chunk number 90: alz-3b
> ###################################################
> qnorm((1-(1-0.05)^(1/8))/2, lower.tail = FALSE)
[1] 2.727008
> 
> 
> ###################################################
> ### chunk number 91: alz-4
> ###################################################
> alzheimer.ci$confint <- apply(alzheimer.ci$confint, 2, 
+                                binomial()$linkinv)
> plot(alzheimer.ci, main = "", xlim = c(0, 1))
> 
> 
> ###################################################
> ### chunk number 92: alzheimer-plot2
> ###################################################
> plot(alzheimer.ci, xlab = "Probability of suffering from Alzheimer's disease", 
+      xlim = c(0, 1), ylim = c(0.5, 8.5), main = "")
> 
> 
> ###################################################
> ### chunk number 93: alm-0
> ###################################################
> library("TH.data")
> load(file.path(path.package(package = "TH.data"), "rda", "AML_Bullinger.rda"))
> 
> risk <- rep(0, nrow(clinical))
> rlev <- levels(clinical[, "Cytogenetic.group"])
> risk[clinical[, "Cytogenetic.group"] %in% rlev[c(7,8,4)]] <- "low"
> risk[clinical[, "Cytogenetic.group"] %in% rlev[c(5, 9)]] <- "intermediate"
> risk[clinical[, "Cytogenetic.group"] %in% rlev[-c(4,5, 7,8,9)]] <- "high"
> risk <- as.factor(risk)
> names(clinical)[6] <- "FLT3"
> 
> 
> ###################################################
> ### chunk number 94: alm-options
> ###################################################
> op <- options(show.signif.stars = FALSE)
> 
> 
> ###################################################
> ### chunk number 95: alm-1
> ###################################################
> library("survival")
> aml.surv <- survreg(Surv(time, event) ~ Sex + 
+      Age + WBC + LDH + FLT3 + risk, 
+      data = clinical)
> summary(glht(aml.surv, linfct = mcp(risk = "Tukey")))

	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: survreg(formula = Surv(time, event) ~ Sex + Age + WBC + LDH + 
    FLT3 + risk, data = clinical)

Linear Hypotheses:
                         Estimate Std. Error z value Pr(>|z|)
intermediate - high == 0   1.1101     0.3851   2.882  0.01088
low - high == 0            1.4769     0.4583   3.223  0.00367
low - intermediate == 0    0.3668     0.4303   0.852  0.66918
(Adjusted p values reported -- single-step method)

> 
> 
> ###################################################
> ### chunk number 96: alm-options
> ###################################################
> options(op)
> 
> 
> ###################################################
> ### chunk number 97: tree-1
> ###################################################
> data("trees513", package = "multcomp")
> 
> 
> ###################################################
> ### chunk number 98: trees-setup
> ###################################################
> trees513 <- subset(trees513, !species %in% c("fir", "softwood (other)"))
> trees513$species <- trees513$species[,drop = TRUE]
> levels(trees513$species)[5:6] <- c("ash/maple/elm", "hardwood")
> 
> 
> ###################################################
> ### chunk number 99: tree-2
> ###################################################
> trees513.lme <- glmer(damage ~ species -1 + (1 | lattice/plot), 
+                       data = trees513, family = binomial())
> K <- diag(length(fixef(trees513.lme)))
> 
> 
> ###################################################
> ### chunk number 100: trees-K-cosmetics
> ###################################################
> colnames(K) <- rownames(K) <- 
+     paste(gsub("species", "", names(fixef(trees513.lme))), 
+           " (", table(trees513$species), ")", sep = "")
> 
> 
> ###################################################
> ### chunk number 101: tree-3
> ###################################################
> trees513.ci <- confint(glht(trees513.lme, linfct = K))
> prob <- binomial()$linkinv(trees513.ci$confint)
> trees513.ci$confint <- 1 - prob
> trees513.ci$confint[, 2:3] <- trees513.ci$confint[, 3:2]
> 
> 
> ###################################################
> ### chunk number 102: CItrees
> ###################################################
> plot(trees513.ci, main = "", xlab = "Probability of browsing damage" )
> 
> sessionInfo()
R version 4.4.2 (2024-10-31)
Platform: x86_64-pc-linux-gnu
Running under: Debian GNU/Linux 12 (bookworm)

Matrix products: default
BLAS:   /usr/local/lib/R/lib/libRblas.so 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.11.0

locale:
 [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8    
 [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8   
 [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       

time zone: Europe/Berlin
tzcode source: system (glibc)

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] HH_3.1-52           gridExtra_2.3       latticeExtra_0.6-30
 [4] lattice_0.22-6      multcomp_1.4-26     TH.data_1.1-2      
 [7] MASS_7.3-61         survival_3.7-0      mvtnorm_1.3-2      
[10] lme4_1.1-35.5       Matrix_1.7-1        robustbase_0.99-4-1
[13] sandwich_3.1-1     

loaded via a namespace (and not attached):
 [1] tidyselect_1.2.1   libcoin_1.0-10     Rmpfr_0.9-5        dplyr_1.1.4       
 [5] fastmap_1.2.0      promises_1.3.0     digest_0.6.37      rpart_4.1.23      
 [9] mime_0.12          lifecycle_1.0.4    cluster_2.1.6      magrittr_2.0.3    
[13] compiler_4.4.2     rlang_1.1.4        Hmisc_5.2-0        tools_4.4.2       
[17] utf8_1.2.4         data.table_1.16.2  knitr_1.48         htmlwidgets_1.6.4 
[21] interp_1.1-6       plyr_1.8.9         RColorBrewer_1.1-3 abind_1.4-8       
[25] foreign_0.8-87     nnet_7.3-19        stats4_4.4.2       fansi_1.0.6       
[29] xtable_1.8-4       colorspace_2.1-1   ggplot2_3.5.1      scales_1.3.0      
[33] cli_3.6.3          rmarkdown_2.29     generics_0.1.3     rstudioapi_0.17.1 
[37] reshape2_1.4.4     minqa_1.2.8        stringr_1.5.1      modeltools_0.2-23 
[41] splines_4.4.2      parallel_4.4.2     matrixStats_1.4.1  base64enc_0.1-3   
[45] vctrs_0.6.5        boot_1.3-31        DoseFinding_1.2-1  Formula_1.2-5     
[49] htmlTable_2.4.3    jpeg_0.1-10        vcd_1.4-13         glue_1.8.0        
[53] nloptr_2.1.1       DEoptimR_1.1-3     codetools_0.2-20   stringi_1.8.4     
[57] gtable_0.3.6       later_1.3.2        deldir_2.0-4       lmtest_0.9-40     
[61] gmp_0.7-5          munsell_0.5.1      tibble_3.2.1       pillar_1.9.0      
[65] htmltools_0.5.8.1  R6_2.5.1           shiny_1.9.1        evaluate_1.0.1    
[69] png_0.1-8          backports_1.5.0    leaps_3.2          httpuv_1.6.15     
[73] Rcpp_1.0.13-1      nlme_3.1-166       checkmate_2.3.2    coin_1.4-3        
[77] xfun_0.49          zoo_1.8-12         pkgconfig_2.0.3   
> 
> proc.time()
   user  system elapsed 
  7.712   0.076   7.830 
