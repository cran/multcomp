
R version 2.6.2 (2008-02-08)
Copyright (C) 2008 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> ### mixed effects models
> ### feature request by John Wilkinson <jnwilks@btinternet.com>
> ### and Dieter Menne <dieter.menne@menne-biomed.de>
> 
> library("multcomp")
Loading required package: mvtnorm
> 
> nlmeOK <- require("nlme")
Loading required package: nlme
> lme4OK <- require("lme4")
Loading required package: lme4
Loading required package: Matrix
Loading required package: lattice

Attaching package: 'Matrix'


	The following object(s) are masked from package:stats :

	 xtabs 


Attaching package: 'lme4'


	The following object(s) are masked from package:nlme :

	 BIC,
	 fixef,
	 gsummary,
	 lmList,
	 pooledSD,
	 ranef,
	 VarCorr 

Warning messages:
1: In namespaceImportFrom(self, asNamespace(ns)) :
  replacing previous import: cov2cor
2: In namespaceImportFrom(self, asNamespace(ns)) :
  replacing previous import: xtabs
> if (lme4OK) {
+ 
+     data("ergoStool", package = "nlme")
+     K <- glht(aov(effort ~ Type, data = ergoStool), mcp(Type = "Tukey"))$linfct
+ 
+     stool.lmer <- lmer(effort ~ Type + (1 | Subject),
+                        data = ergoStool)
+     glme4 <- glht(stool.lmer, K)
+     glme41 <- glht(stool.lmer, mcp(Type = "Tukey"))
+     stopifnot(all.equal(coef(glme4), coef(glme41)))
+ 
+     if (nlmeOK) {
+         stool.lme <- lme(effort ~ Type, data = ergoStool,
+                         random = ~ 1 | Subject)
+         gnlme <- glht(stool.lme,K)
+         stopifnot(all.equal(coef(glme4), coef(gnlme)))
+ 
+         gnlme2 <- glht(stool.lme, linfct = mcp(Type = "Tukey"))
+         stopifnot(all.equal(coef(glme4), coef(gnlme2)))
+     }
+ }
> 
> ### and now for lmer2 as well
> if (lme4OK) {
+ 
+     data("ergoStool", package = "nlme")
+ 
+     stool.lmer <- lmer2(effort ~ Type + (1 | Subject),
+                         data = ergoStool)
+     glme4 <- glht(stool.lmer, K)
+     glme41 <- glht(stool.lmer, mcp(Type = "Tukey"))
+     stopifnot(all.equal(coef(glme4), coef(glme41)))
+ 
+     if (nlmeOK) {
+         stopifnot(all.equal(coef(glme4), coef(gnlme)))
+     }
+ }
> 
> 
